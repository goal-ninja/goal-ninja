<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a1a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Goal Ninja — Get Started</title>
    <script src="./goal-ninja-data.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        :root {
            --bg: #f5f5f5;
            --card-bg: #ffffff;
            --text: #1a1a1a;
            --text-secondary: #666;
            --accent: #E67E22;
            --accent-light: rgba(230, 126, 34, 0.1);
            --success: #22c55e;
            --danger: #ef4444;
            --border: #e5e5e5;
            --radius: 16px;
            --radius-sm: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
            background: #f5f5f5;
            color: var(--text);
            -webkit-font-smoothing: antialiased;
            overflow: hidden;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Phone Frame */
        .phone-frame {
            width: 100vw;
            height: 100vh;
            max-width: 100%;
            background: var(--bg);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        @media (min-width: 500px) {
            body { background: #e5e5e5; }
            .phone-frame {
                width: 390px;
                height: 844px;
                max-height: 95vh;
                border-radius: 40px;
                box-shadow: 0 25px 80px rgba(0,0,0,0.15);
            }
        }

        /* Progress Bar */
        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--border);
            z-index: 100;
        }
        .progress-bar .fill {
            height: 100%;
            background: var(--accent);
            transition: width 0.4s ease;
            border-radius: 0 2px 2px 0;
        }

        /* Back Button */
        .back-btn {
            position: absolute;
            top: 16px;
            left: 16px;
            z-index: 101;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(0,0,0,0.06);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .back-btn:active { transform: scale(0.92); }
        .back-btn svg { width: 18px; height: 18px; stroke: var(--text); }
        .back-btn.hidden { display: none; }

        /* Carousel */
        .carousel {
            flex: 1;
            display: flex;
            transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: transform;
            min-height: 0;
        }
        .screen {
            min-width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 60px 24px 100px;
            overflow-y: auto;
            position: relative;
        }

        /* Shared Typography */
        .screen h1 {
            font-size: 32px;
            font-weight: 700;
            text-align: left;
            line-height: 1.2;
            margin-bottom: 12px;
            letter-spacing: -0.5px;
            width: 100%;
            max-width: 340px;
        }
        .screen h1 span {
            color: var(--accent);
        }
        .screen h2 {
            font-size: 26px;
            font-weight: 700;
            text-align: left;
            line-height: 1.2;
            margin-bottom: 8px;
            letter-spacing: -0.3px;
            width: 100%;
            max-width: 340px;
        }
        .screen .subtitle {
            font-size: 17px;
            color: var(--text-secondary);
            text-align: left;
            line-height: 1.5;
            margin-bottom: 24px;
            max-width: 340px;
            width: 100%;
        }

        /* Centered text exceptions (celebration screens) */
        #screen12 h2, #screen12 .subtitle,
        #screen13 h2, #screen13 .subtitle {
            text-align: center;
        }

        /* Stat Card (light) */
        .stat-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 20px;
            margin-top: 24px;
            width: 100%;
            max-width: 340px;
        }
        .stat-number {
            font-size: 48px;
            font-weight: 700;
            letter-spacing: -2px;
            line-height: 1;
            margin-bottom: 8px;
        }
        .stat-label {
            font-size: 15px;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        .stat-source {
            font-size: 12px;
            color: #999999;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        /* Ninja Image */
        .ninja-img {
            width: 140px;
            height: 140px;
            object-fit: contain;
            margin-top: 20px;
            margin-bottom: 20px;
            animation: ninjaFloat 2.5s ease-in-out infinite;
        }
        .ninja-img.small { width: 100px; height: 100px; }
        @keyframes ninjaFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        /* Primary Button — fixed at bottom of screen */
        .btn-primary {
            width: calc(100% - 48px);
            max-width: 320px;
            padding: 16px 24px;
            background: var(--text);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            letter-spacing: -0.2px;
            position: absolute;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2;
        }
        .btn-primary:active { transform: translateX(-50%) scale(0.97); opacity: 0.9; }
        .btn-primary:disabled { opacity: 0.4; pointer-events: none; }
        .btn-primary.accent { background: var(--accent); }

        /* Text Button */
        .btn-text {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 12px;
            margin-top: 4px;
            position: sticky;
            bottom: 0;
            flex-shrink: 0;
            z-index: 2;
        }
        .btn-text:active { opacity: 0.6; }

        /* Text Input */
        .text-input {
            width: 100%;
            max-width: 320px;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-size: 17px;
            font-weight: 500;
            background: #ffffff;
            color: var(--text);
            text-align: center;
            transition: border-color 0.2s;
            outline: none;
            margin-bottom: 24px;
        }
        .text-input:focus { border-color: var(--accent); }
        .text-input::placeholder { color: #ccc; }

        /* Selection Cards */
        .card-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            width: 100%;
            max-width: 340px;
            margin-bottom: 24px;
        }
        .card-grid.single-col {
            grid-template-columns: 1fr;
        }
        .select-card {
            background: #ffffff;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 16px 14px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            user-select: none;
        }
        .select-card:active { transform: scale(0.97); }
        .select-card.selected {
            border-color: var(--accent);
            background: var(--accent-light);
        }
        .select-card .card-emoji {
            font-size: 28px;
            margin-bottom: 6px;
            display: block;
        }
        .select-card .card-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 6px;
            color: #1a1a1a;
        }
        .select-card .card-icon svg {
            width: 28px;
            height: 28px;
        }
        .select-card .card-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 2px;
        }
        .select-card .card-desc {
            font-size: 11px;
            color: var(--text-secondary);
            line-height: 1.3;
        }
        .select-card.single-col-card {
            display: flex;
            align-items: center;
            gap: 14px;
            text-align: left;
            padding: 14px 16px;
        }
        .select-card.single-col-card .card-emoji {
            font-size: 24px;
            margin-bottom: 0;
            flex-shrink: 0;
        }
        .select-card.single-col-card .card-icon {
            margin-bottom: 0;
            flex-shrink: 0;
        }
        .select-card.single-col-card .card-icon svg {
            width: 24px;
            height: 24px;
        }

        /* Ninja Response Bubble */
        .ninja-response {
            background: var(--accent-light);
            border-radius: 20px;
            padding: 12px 18px;
            font-size: 14px;
            font-weight: 500;
            color: var(--accent);
            text-align: center;
            margin-bottom: 16px;
            max-width: 300px;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.3s ease;
        }
        .ninja-response.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Plan Card */
        .plan-card {
            background: #ffffff;
            border-radius: var(--radius);
            padding: 20px;
            width: 100%;
            max-width: 340px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            margin-bottom: 20px;
        }
        .plan-card .plan-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        .plan-card .plan-icon {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: var(--accent-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }
        .plan-card .plan-name {
            font-size: 18px;
            font-weight: 700;
        }
        .plan-card .plan-detail {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }
        .plan-card .plan-detail:last-child { border-bottom: none; }
        .plan-card .plan-label { color: var(--text-secondary); }
        .plan-card .plan-value { font-weight: 600; }
        .plan-habits-list {
            margin-top: 12px;
        }
        .plan-habit-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }
        .plan-habit-item:last-child { border-bottom: none; }
        .plan-habit-name { font-weight: 500; }
        .plan-habit-penalty { color: var(--accent); font-weight: 600; }
        .plan-habit-penalty-badge {
            background: rgba(230,126,34,0.1);
            color: var(--accent);
            font-weight: 700;
            font-size: 13px;
            padding: 3px 10px;
            border-radius: 20px;
            white-space: nowrap;
        }

        /* Customize Form */
        .form-group {
            width: 100%;
            max-width: 340px;
            margin-bottom: 16px;
        }
        .form-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: block;
        }
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 16px;
            font-weight: 500;
            background: #ffffff;
            color: var(--text);
            outline: none;
            transition: border-color 0.2s;
        }
        .form-input:focus { border-color: var(--accent); }

        /* Icon Grid */
        .icon-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .icon-option {
            width: 42px;
            height: 42px;
            border-radius: 10px;
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            background: #ffffff;
        }
        .icon-option:active { transform: scale(0.92); }
        .icon-option.selected {
            border-color: var(--accent);
            background: var(--accent-light);
        }

        /* Habit Edit Item */
        .habit-edit-item {
            background: #ffffff;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 14px;
            margin-bottom: 10px;
        }
        .habit-edit-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .habit-edit-name {
            flex: 1;
            border: none;
            font-size: 15px;
            font-weight: 500;
            background: transparent;
            color: var(--text);
            outline: none;
        }
        .habit-edit-penalty {
            width: 60px;
            text-align: center;
            border: 1.5px solid var(--border);
            border-radius: 8px;
            padding: 6px;
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
            outline: none;
            background: #ffffff;
        }
        .habit-edit-penalty:focus { border-color: var(--accent); }
        .habit-remove-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: none;
            background: rgba(239,68,68,0.1);
            color: var(--danger);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .add-habit-btn {
            width: 100%;
            padding: 12px;
            border: 2px dashed var(--border);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 16px;
            transition: all 0.2s;
        }
        .add-habit-btn:active { border-color: var(--accent); color: var(--accent); }

        /* Habit Frequency Row */
        .habit-freq-row {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 8px;
        }
        .habit-freq-row .freq-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        .habit-freq-num {
            width: 44px;
            border: 1.5px solid var(--border);
            border-radius: 8px;
            padding: 5px 6px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
            background: #ffffff;
            text-align: center;
            outline: none;
            font-family: inherit;
        }
        .habit-freq-num:focus { border-color: var(--accent); }
        .habit-freq-unit {
            border: 1.5px solid var(--border);
            border-radius: 8px;
            padding: 5px 8px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text);
            background: #ffffff;
            font-family: inherit;
            cursor: pointer;
            outline: none;
            -webkit-appearance: none;
        }
        .habit-freq-unit:focus { border-color: var(--accent); }

        /* Habit Edit Icon */
        .habit-edit-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--accent-light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .habit-edit-icon:active { transform: scale(0.92); }

        /* Habit Icon Picker Overlay */
        .habit-icon-picker-overlay {
            display: none;
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            z-index: 200;
            align-items: flex-end;
            justify-content: center;
        }
        .habit-icon-picker-overlay.active { display: flex; }
        .habit-icon-picker-modal {
            background: #ffffff;
            border-radius: 20px 20px 0 0;
            padding: 16px 20px 28px;
            width: 100%;
            max-width: 390px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        .habit-icon-picker-overlay.active .habit-icon-picker-modal {
            transform: translateY(0);
        }
        .habit-icon-picker-handle {
            width: 36px;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            margin: 0 auto 12px;
        }
        .habit-icon-picker-title {
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 16px;
        }
        .habit-icon-picker-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        .habit-icon-pick-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 10px 4px;
            border-radius: 12px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.15s;
        }
        .habit-icon-pick-item:active { transform: scale(0.95); }
        .habit-icon-pick-item.selected {
            background: var(--accent-light);
            border-color: var(--accent);
        }
        .habit-icon-pick-circle {
            width: 40px;
            height: 40px;
            background: var(--bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .habit-icon-pick-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: capitalize;
        }

        /* Summary Card */
        .onb-summary-card {
            background: #ffffff;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 0;
            width: 100%;
            max-width: 340px;
            margin-bottom: 12px;
            overflow: hidden;
        }
        .onb-summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            font-size: 14px;
            border-bottom: 1px solid var(--border);
        }
        .onb-summary-row:last-child { border-bottom: none; }
        .onb-summary-row .summary-label { color: var(--text-secondary); }
        .onb-summary-row .summary-val { font-weight: 700; }
        .onb-info-tip {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px 14px;
            width: 100%;
            max-width: 340px;
            margin-bottom: 20px;
        }
        .onb-info-tip svg { flex-shrink: 0; color: var(--text-secondary); margin-top: 1px; }
        .onb-info-tip span { font-size: 13px; color: var(--text-secondary); line-height: 1.4; }

        /* Textarea */
        textarea.form-input {
            font-family: inherit;
            resize: none;
            line-height: 1.5;
        }

        /* Settings Card */
        .settings-card {
            background: #ffffff;
            border-radius: var(--radius-sm);
            border: 2px solid var(--border);
            overflow: hidden;
        }
        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 14px;
            position: relative;
        }
        .settings-row + .settings-row {
            border-top: 1px solid var(--border);
        }
        .settings-row .settings-label {
            font-size: 14px;
            font-weight: 500;
        }
        .settings-row .settings-value {
            font-size: 14px;
            color: var(--text-secondary);
        }
        .settings-row input[type="time"],
        .settings-row input[type="date"] {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        /* Duration Pills */
        .pill-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .pill {
            padding: 10px 18px;
            border: 2px solid var(--border);
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            background: #ffffff;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
        }
        .pill:active { transform: scale(0.95); }
        .pill.selected {
            border-color: var(--accent);
            background: var(--accent-light);
            color: var(--accent);
        }

        /* Target Slider */
        .target-slider-wrap {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .target-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            border-radius: 3px;
            background: var(--border);
            outline: none;
        }
        .target-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(230,126,34,0.3);
        }
        .target-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent);
            min-width: 48px;
            text-align: right;
        }

        /* Pro Badge */
        .pro-badge {
            display: inline-flex;
            align-items: center;
            gap: 3px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 7px;
            border-radius: 6px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            vertical-align: middle;
            margin-left: 6px;
        }

        /* Commitment Checks */
        .commit-list {
            width: 100%;
            max-width: 340px;
            margin-bottom: 24px;
        }
        .commit-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            background: #ffffff;
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
            border: 2px solid var(--border);
        }
        .commit-item.checked {
            border-color: var(--success);
            background: rgba(34,197,94,0.05);
        }
        .commit-check {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .commit-item.checked .commit-check {
            background: var(--success);
            border-color: var(--success);
        }
        .commit-check svg { opacity: 0; transition: opacity 0.2s; }
        .commit-item.checked .commit-check svg { opacity: 1; }
        .commit-text { font-size: 14px; font-weight: 500; line-height: 1.4; }

        /* Payment Visual */
        .payment-visual {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            margin-bottom: 24px;
            padding: 24px;
            background: #ffffff;
            border-radius: var(--radius);
            border: 2px solid var(--border);
            width: 100%;
            max-width: 300px;
        }
        .payment-card-icon { color: var(--text-secondary); }
        .payment-methods { font-size: 13px; color: var(--text-secondary); margin: 0; }

        /* Feature Compare */
        .compare-table {
            width: 100%;
            max-width: 340px;
            margin-bottom: 20px;
        }
        .compare-header {
            display: grid;
            grid-template-columns: 1fr 80px 80px;
            padding: 10px 0;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--border);
        }
        .compare-row {
            display: grid;
            grid-template-columns: 1fr 80px 80px;
            padding: 12px 0;
            font-size: 13px;
            border-bottom: 1px solid var(--border);
            align-items: center;
        }
        .compare-row .feature { font-weight: 500; }
        .compare-row .check { text-align: center; font-size: 16px; }
        .compare-row .check.yes { color: var(--success); }
        .compare-row .check.no { color: #ddd; }
        .compare-row .check.pro { color: var(--accent); }

        /* Social Proof Screen */
        .screen-dark {
            background: var(--text);
            color: white;
        }
        .screen-dark .subtitle { color: rgba(255,255,255,0.6); }
        .stat-big {
            font-size: 48px;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 4px;
        }
        .stat-card-dark {
            background: rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 20px;
            width: 100%;
            max-width: 340px;
            margin-bottom: 24px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .stat-card-number {
            font-size: 48px;
            font-weight: 700;
            letter-spacing: -2px;
            line-height: 1;
            margin-bottom: 8px;
            color: var(--accent);
        }
        .stat-card-label {
            font-size: 15px;
            color: rgba(255,255,255,0.7);
            line-height: 1.4;
        }
        .stat-card-source {
            font-size: 12px;
            color: rgba(255,255,255,0.35);
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* How It Works Steps */
        .steps-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
            width: 100%;
            max-width: 340px;
        }
        .step-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: flex-start;
            gap: 16px;
        }
        .step-ninja {
            width: 44px;
            height: 44px;
            flex-shrink: 0;
        }
        .step-ninja img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .step-content h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .step-content p {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Calculating Spinner */
        .calc-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 16px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .calc-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: absolute;
            inset: 0;
            transition: opacity 0.4s;
        }
        .calc-wrap.hidden { opacity: 0; pointer-events: none; }

        /* Success Confetti */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            top: -20px;
            width: 10px;
            height: 14px;
            border-radius: 2px;
            animation: confettiFall 3s ease-out forwards;
        }
        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        /* Summary Card */
        .summary-card {
            background: #ffffff;
            border-radius: var(--radius);
            padding: 24px;
            width: 100%;
            max-width: 340px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            text-align: center;
            margin-bottom: 24px;
        }
        .summary-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            background: var(--accent-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-size: 28px;
        }
        .summary-goal-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 16px;
        }
        .summary-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }
        .summary-stat {
            text-align: center;
        }
        .summary-stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent);
        }
        .summary-stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Quick Win Check-in */
        .qw-habit {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 16px;
            background: #ffffff;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            width: 100%;
            max-width: 340px;
            transition: all 0.2s;
        }
        .qw-habit.done {
            border-color: var(--success);
            background: rgba(34,197,94,0.05);
        }
        .qw-habit-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .qw-habit-name { font-size: 15px; font-weight: 500; }
        .qw-check-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid var(--border);
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .qw-check-btn:active { transform: scale(0.9); }
        .qw-habit.done .qw-check-btn {
            background: var(--success);
            border-color: var(--success);
        }

        /* Scrollable screen override */
        .screen.scrollable {
            padding-top: 64px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

/* ===== Screen 8: Create-from-Template Parity ===== */

#screen8 .form-group {
    max-width: 100%;
    margin-bottom: 24px;
    width: 100%;
}

#screen8 .form-label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 10px;
    color: #999999;
}
#screen8 .form-label-hint {
    font-size: 12px;
    font-weight: 400;
    text-transform: none;
    letter-spacing: 0;
    color: #999999;
}

#screen8 .form-card {
    background: #ffffff;
    border-radius: 14px;
    overflow: hidden;
}

#screen8 .input-field {
    padding: 16px;
    border-bottom: 1px solid #e5e5e5;
}
#screen8 .input-field:last-child { border-bottom: none; }
#screen8 .input-field input {
    width: 100%;
    border: none;
    background: none;
    font-size: 17px;
    font-family: inherit;
    color: #1a1a1a;
    outline: none;
}
#screen8 .input-field input::placeholder { color: #999999; }
#screen8 .input-field textarea {
    width: 100%;
    border: none;
    background: none;
    font-size: 15px;
    font-family: inherit;
    color: #1a1a1a;
    outline: none;
    resize: none;
    min-height: 60px;
    line-height: 1.5;
}
#screen8 .input-field textarea::placeholder { color: #999999; }

/* Large centered goal icon */
#screen8 .icon-section {
    text-align: center;
    margin-bottom: 28px;
    width: 100%;
}
#screen8 .mission-icon-large {
    width: 88px;
    height: 88px;
    background: #ffffff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    position: relative;
    cursor: pointer;
    transition: transform 0.2s;
}
#screen8 .mission-icon-large:active { transform: scale(1.05); }
#screen8 .edit-icon-badge {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 28px;
    height: 28px;
    background: #1a1a1a;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 3px solid #f5f5f5;
}
#screen8 .edit-icon-badge svg { width: 12px; height: 12px; color: white; stroke: white; }
#screen8 .change-icon-text {
    font-size: 13px;
    color: #6b6b6b;
}

/* Habit form cards */
#screen8 .habit-form-card {
    background: #ffffff;
    border-radius: 14px;
    padding: 14px 16px;
    margin-bottom: 8px;
    position: relative;
}
#screen8 .habit-form-row {
    display: flex;
    gap: 10px;
    align-items: center;
}
#screen8 .habit-form-icon {
    width: 40px;
    height: 40px;
    background: #f5f5f5;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    cursor: pointer;
}
#screen8 .habit-form-fields { flex: 1; min-width: 0; }
#screen8 .habit-name-input {
    width: 100%;
    border: none;
    font-size: 15px;
    font-weight: 600;
    color: #1a1a1a;
    background: none;
    outline: none;
    padding: 0;
    margin-bottom: 4px;
    font-family: inherit;
}
#screen8 .habit-name-input::placeholder { color: #999999; font-weight: 400; }
#screen8 .habit-penalty-row {
    display: flex;
    align-items: center;
    gap: 6px;
}
#screen8 .habit-penalty-row span { font-size: 12px; color: #999999; }
#screen8 .habit-penalty-input {
    width: 50px;
    border: 1px solid #e5e5e5;
    border-radius: 6px;
    padding: 2px 6px;
    font-size: 13px;
    font-weight: 600;
    color: #1a1a1a;
    text-align: center;
    background: #f5f5f5;
    font-family: inherit;
}
#screen8 .habit-freq-row {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 6px;
}
#screen8 .habit-freq-row .freq-label { font-size: 12px; color: #999999; }
#screen8 .habit-freq-num {
    width: 36px;
    padding: 2px 4px;
    border: 1px solid #e5e5e5;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    color: #1a1a1a;
    background: #f5f5f5;
    text-align: center;
    font-family: inherit;
}
#screen8 .habit-freq-unit {
    border: 1px solid #e5e5e5;
    border-radius: 6px;
    padding: 2px 6px;
    font-size: 12px;
    font-weight: 500;
    color: #1a1a1a;
    background: #f5f5f5;
    cursor: pointer;
    font-family: inherit;
}
#screen8 .remove-habit-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #f5f5f5;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #999999;
}
#screen8 .remove-habit-btn:active { background: #fee2e2; color: #ef4444; }

#screen8 .add-habit-btn {
    width: 100%;
    padding: 12px;
    border: 2px dashed #e5e5e5;
    border-radius: 14px;
    background: none;
    font-size: 14px;
    font-weight: 500;
    color: #6b6b6b;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-family: inherit;
    margin-top: 4px;
}
#screen8 .add-habit-btn:active { border-color: #1a1a1a; color: #1a1a1a; }

/* Duration options */
#screen8 .duration-options {
    display: flex;
    gap: 10px;
    padding: 16px;
}
#screen8 .duration-option {
    flex: 1;
    background: #f5f5f5;
    border: 2px solid transparent;
    border-radius: 12px;
    padding: 14px 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}
#screen8 .duration-option:active { transform: scale(0.95); }
#screen8 .duration-option.selected { border-color: #1a1a1a; }
#screen8 .duration-days { font-size: 22px; font-weight: 700; color: #1a1a1a; }
#screen8 .duration-label { font-size: 11px; color: #999999; }
#screen8 .duration-option.no-end .duration-days { font-size: 16px; }

#screen8 .custom-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 0 16px 16px;
}
#screen8 .custom-label { font-size: 13px; color: #999999; white-space: nowrap; }
#screen8 .custom-input-wrap {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 4px;
    background: #f5f5f5;
    border: 2px solid #e5e5e5;
    border-radius: 10px;
    padding: 10px 12px;
    transition: border-color 0.2s;
}
#screen8 .custom-input-wrap:focus-within { border-color: #1a1a1a; }
#screen8 .custom-input {
    flex: 1;
    border: none;
    background: none;
    font-size: 15px;
    font-weight: 600;
    font-family: inherit;
    color: #1a1a1a;
    outline: none;
    width: 60px;
}
#screen8 .custom-input::placeholder { color: #999999; font-weight: 400; }
#screen8 .custom-suffix { font-size: 13px; color: #999999; }

/* Target section */
#screen8 .target-section { padding: 16px; }
#screen8 .target-display { text-align: center; margin-bottom: 16px; }
#screen8 .target-value-lg {
    font-size: 48px;
    font-weight: 700;
    letter-spacing: -2px;
    color: #1a1a1a;
}
#screen8 .target-desc { font-size: 14px; color: #6b6b6b; margin-top: 4px; }
#screen8 .target-slider {
    width: 100%;
    -webkit-appearance: none;
    height: 8px;
    border-radius: 4px;
    background: #e5e5e5;
    outline: none;
}
#screen8 .target-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #1a1a1a;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

/* Settings (selector-field style) */
#screen8 .selector-field {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    border-bottom: 1px solid #e5e5e5;
    cursor: pointer;
    position: relative;
}
#screen8 .selector-field:last-child { border-bottom: none; }
#screen8 .selector-label { font-size: 16px; color: #1a1a1a; }
#screen8 .selector-value {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #6b6b6b;
    font-size: 16px;
}
#screen8 .selector-value svg { width: 16px; height: 16px; color: #999999; }

/* Summary card */
#screen8 .summary-card {
    background: #ffffff;
    border-radius: 14px;
    padding: 20px;
    width: 100%;
}
#screen8 .summary-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; color: #6b6b6b; }
#screen8 .summary-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid #e5e5e5;
}
#screen8 .summary-row:last-child { border-bottom: none; padding-bottom: 0; }
#screen8 .summary-row:first-of-type { padding-top: 0; }
#screen8 .s-label { font-size: 14px; color: #6b6b6b; }
#screen8 .s-value { font-size: 14px; font-weight: 600; }

/* Info tip */
#screen8 .info-tip {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    background: #f5f5f5;
    border: 1px solid #e5e5e5;
    border-radius: 12px;
    padding: 14px 16px;
    margin-top: 20px;
    width: 100%;
}
#screen8 .info-tip svg { width: 20px; height: 20px; color: #999999; flex-shrink: 0; margin-top: 1px; }
#screen8 .info-tip p { font-size: 13px; color: #6b6b6b; line-height: 1.4; margin: 0; }

/* Bottom CTA */
#screen8 .bottom-cta {
    position: sticky;
    bottom: 24px;
    width: 100%;
    max-width: 340px;
    margin-top: auto;
    flex-shrink: 0;
    z-index: 2;
}
#screen8 .start-btn {
    width: 100%;
    background: #1a1a1a;
    color: white;
    font-size: 17px;
    font-weight: 600;
    padding: 18px;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    transition: opacity 0.2s, transform 0.2s;
    font-family: inherit;
}
#screen8 .start-btn:active { transform: scale(0.98); }

/* Animations */
#screen8 .animate-in {
    animation: onbFadeUp 0.4s ease-out both;
}
@keyframes onbFadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
}
#screen8 .delay-1 { animation-delay: 0.05s; }
#screen8 .delay-2 { animation-delay: 0.1s; }
#screen8 .delay-3 { animation-delay: 0.15s; }
#screen8 .delay-4 { animation-delay: 0.2s; }

/* Goal icon picker overlay */
#goalIconPickerOverlay {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 200;
    align-items: flex-end;
    justify-content: center;
}
#goalIconPickerOverlay.active { display: flex; }

/* ===== Screen 10: Payment Card ===== */
#screen10 .payment-card {
    background: #ffffff;
    border-radius: 16px;
    padding: 24px 20px;
    text-align: center;
    width: 100%;
}
#screen10 .payment-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1a1a1a;
}
#screen10 .payment-desc {
    font-size: 14px;
    color: #6b6b6b;
    margin-bottom: 20px;
    line-height: 1.5;
}
#screen10 .payment-benefits {
    text-align: left;
    margin-bottom: 24px;
}
#screen10 .benefit-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 0;
    border-bottom: 1px solid #e5e5e5;
}
#screen10 .benefit-item:last-child { border-bottom: none; }
#screen10 .benefit-icon {
    width: 24px;
    height: 24px;
    color: #1a1a1a;
    flex-shrink: 0;
}
#screen10 .benefit-text { font-size: 14px; color: #1a1a1a; }
#screen10 .connect-btn {
    width: 100%;
    background: #1a1a1a;
    color: white;
    font-size: 16px;
    font-weight: 600;
    padding: 16px;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    margin-bottom: 12px;
    font-family: inherit;
}
#screen10 .connect-btn:active { transform: scale(0.98); }
#screen10 .skip-payment-btn {
    width: 100%;
    background: none;
    color: #6b6b6b;
    font-size: 15px;
    padding: 12px;
    border: none;
    cursor: pointer;
    font-family: inherit;
}
    </style>
</head>
<body>
<div class="phone-frame">
    <!-- Progress Bar -->
    <div class="progress-bar"><div class="fill" id="progressFill" style="width: 0%"></div></div>

    <!-- Back Button -->
    <button class="back-btn hidden" id="backBtn" onclick="goBack()">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 18l-6-6 6-6"/>
        </svg>
    </button>

    <!-- Carousel -->
    <div class="carousel" id="carousel">

        <!-- ==================== SCREEN 6: SOCIAL PROOF ==================== -->
        <div class="screen" id="screen6">
            <h1>Build habits,<br>grow your <span>savings</span>.</h1>
            <p class="subtitle">Set goals with habits, choose your stakes, and stay accountable. Miss a habit? Your penalty goes straight into your savings.</p>
            <div class="stat-card">
                <div class="stat-number">95%</div>
                <div class="stat-label">of people complete their goals when they have accountability with real stakes.</div>
                <div class="stat-source">American Society of Training & Development</div>
            </div>
            <button class="btn-primary" onclick="goNext()">Get Started</button>
        </div>

        <!-- ==================== SCREEN 1: WELCOME ==================== -->
        <div class="screen" id="screen1">
            <img src="../ninja-poses/ninja-mentor.png" alt="Goal Ninja" class="ninja-img">
            <h1>Hey, I'm your accountability buddy</h1>
            <p class="subtitle">I'm here to help you crush your goals, one habit at a time.</p>
            <button class="btn-primary" onclick="goNext()">Let's Go</button>
        </div>

        <!-- ==================== SCREEN 2: NAME ==================== -->
        <div class="screen" id="screen2">
            <img src="../ninja-poses/ninja-thumbsup.png" alt="Ninja" class="ninja-img small">
            <h2>I'd love to know your name</h2>
            <p class="subtitle">We should be on a first-name basis, don't you think?</p>
            <input type="text" class="text-input" id="nameInput" placeholder="Your name" maxlength="24" autocomplete="off" oninput="onNameInput()">
            <button class="btn-primary" id="nameContinueBtn" onclick="saveName(); goNext()">Continue</button>
        </div>

        <!-- ==================== SCREEN: HOW IT WORKS ==================== -->
        <div class="screen scrollable" id="screenHIW">
            <h2>How it works</h2>
            <p class="subtitle">Simple accountability that actually works.</p>
            <div class="steps-container">
                <div class="step-card">
                    <div class="step-ninja">
                        <img src="../ninja-poses/ninja-focus.png" alt="Create">
                    </div>
                    <div class="step-content">
                        <h3>Create a goal</h3>
                        <p>Pick your goal, add habits to it, set how often you need to complete them, and choose your penalty for missed days.</p>
                    </div>
                </div>
                <div class="step-card">
                    <div class="step-ninja">
                        <img src="../ninja-poses/ninja-goalslash.png" alt="Check in">
                    </div>
                    <div class="step-content">
                        <h3>Check in daily</h3>
                        <p>Check in daily on your habits. Complete them and your ninja celebrates! Miss one and the penalty goes to your savings.</p>
                    </div>
                </div>
                <div class="step-card">
                    <div class="step-ninja">
                        <img src="../ninja-poses/ninja-wealth.png" alt="Savings">
                    </div>
                    <div class="step-content">
                        <h3>Hit your target, unlock savings</h3>
                        <p>Hit your target completion rate (default 80%) and your savings unlock. Fall short and you can withdraw early for a small fee.</p>
                    </div>
                </div>
            </div>
            <button class="btn-primary" onclick="goNext()">Continue</button>
        </div>

        <!-- ==================== SCREEN 4: EXPERIENCE ==================== -->
        <div class="screen" id="screen4">
            <img src="../ninja-poses/ninja-mentor.png" alt="Ninja" class="ninja-img small" id="expNinja">
            <div class="ninja-response" id="expResponse"></div>
            <h2>Have you tried habit tracking before?</h2>
            <p class="subtitle">No wrong answer — this helps us tailor your experience.</p>
            <div class="card-grid single-col" id="expGrid">
                <div class="select-card single-col-card" data-exp="new" onclick="selectExp(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18M3 12h18"/><circle cx="12" cy="12" r="9"/></svg></span>
                    <div>
                        <div class="card-title">I'm new to this</div>
                        <div class="card-desc">Haven't really tracked habits before</div>
                    </div>
                </div>
                <div class="select-card single-col-card" data-exp="tried" onclick="selectExp(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg></span>
                    <div>
                        <div class="card-title">I've tried apps before</div>
                        <div class="card-desc">But couldn't stay consistent</div>
                    </div>
                </div>
                <div class="select-card single-col-card" data-exp="pro" onclick="selectExp(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></span>
                    <div>
                        <div class="card-title">I'm a pro</div>
                        <div class="card-desc">I just need better accountability</div>
                    </div>
                </div>
            </div>
            <button class="btn-primary" id="expBtn" disabled onclick="goNext()">Continue</button>
        </div>

        <!-- ==================== SCREEN 5: PAIN POINTS ==================== -->
        <div class="screen scrollable" id="screen5">
            <img src="../ninja-poses/ninja-mentor.png" alt="Ninja" class="ninja-img small" id="painNinja">
            <div class="ninja-response" id="painResponse"></div>
            <h2>What usually gets in the way?</h2>
            <p class="subtitle">Pick all that apply — we'll help you beat them.</p>
            <div class="card-grid single-col" id="painGrid">
                <div class="select-card single-col-card" data-pain="motivation" onclick="togglePain(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/><circle cx="12" cy="12" r="10"/></svg></span>
                    <div>
                        <div class="card-title">I lose motivation</div>
                        <div class="card-desc">Give up after a few days</div>
                    </div>
                </div>
                <div class="select-card single-col-card" data-pain="streak" onclick="togglePain(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg></span>
                    <div>
                        <div class="card-title">Breaking a streak feels like failure</div>
                        <div class="card-desc">One miss and I quit entirely</div>
                    </div>
                </div>
                <div class="select-card single-col-card" data-pain="consequences" onclick="togglePain(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><line x1="4" y1="4" x2="20" y2="20"/></svg></span>
                    <div>
                        <div class="card-title">No real consequences</div>
                        <div class="card-desc">Nothing happens when I skip</div>
                    </div>
                </div>
                <div class="select-card single-col-card" data-pain="forget" onclick="togglePain(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></span>
                    <div>
                        <div class="card-title">I forget or get too busy</div>
                        <div class="card-desc">Life gets in the way</div>
                    </div>
                </div>
            </div>
            <button class="btn-primary" id="painBtn" disabled onclick="goNext()">Continue</button>
        </div>

        <!-- ==================== SCREEN 3: GOAL AREA ==================== -->
        <div class="screen scrollable" id="screen3">
            <h2 id="goalAreaTitle">Alright, let's dive into your goals</h2>
            <p class="subtitle">Pick as many categories as you like.</p>
            <div class="card-grid" id="goalAreaGrid">
                <div class="select-card" data-area="fitness" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 6.5a2 2 0 0 1 3 0L12 9l2.5-2.5a2 2 0 0 1 3 3L15 12l2.5 2.5a2 2 0 0 1-3 3L12 15l-2.5 2.5a2 2 0 0 1-3-3L9 12 6.5 9.5a2 2 0 0 1 0-3z"/><line x1="3" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="21" y2="12"/><line x1="12" y1="3" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="21"/></svg></span>
                    <div class="card-title">Get Fit</div>
                    <div class="card-desc">Exercise, diet, health</div>
                </div>
                <div class="select-card" data-area="learning" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg></span>
                    <div class="card-title">Learn Something</div>
                    <div class="card-desc">Reading, study, skills</div>
                </div>
                <div class="select-card" data-area="saving" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></span>
                    <div class="card-title">Save Money</div>
                    <div class="card-desc">Spending, budgeting</div>
                </div>
                <div class="select-card" data-area="mindfulness" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></span>
                    <div class="card-title">Be Mindful</div>
                    <div class="card-desc">Meditation, sleep, screen time</div>
                </div>
                <div class="select-card" data-area="breaking" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/><line x1="2" y1="2" x2="22" y2="22"/></svg></span>
                    <div class="card-title">Break Bad Habits</div>
                    <div class="card-desc">Social media, junk food</div>
                </div>
                <div class="select-card" data-area="routine" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span>
                    <div class="card-title">Build a Routine</div>
                    <div class="card-desc">Morning routine, daily structure</div>
                </div>
                <div class="select-card" data-area="productivity" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg></span>
                    <div class="card-title">Stay Productive</div>
                    <div class="card-desc">Focus, deep work, time management</div>
                </div>
                <div class="select-card" data-area="wellness" onclick="toggleArea(this)">
                    <span class="card-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.42 4.58a5.4 5.4 0 0 0-7.65 0l-.77.78-.77-.78a5.4 5.4 0 0 0-7.65 7.65l.78.77L12 20.65l7.65-7.65.77-.78a5.4 5.4 0 0 0 0-7.65z"/></svg></span>
                    <div class="card-title">Health & Wellness</div>
                    <div class="card-desc">Sleep, nutrition, self-care</div>
                </div>
            </div>
            <button class="btn-primary" id="goalAreaBtn" disabled onclick="goNext()">Continue</button>
        </div>

        <!-- ==================== SCREEN 7: PERSONALIZED PLAN ==================== -->
        <div class="screen scrollable" id="screen7" style="position: relative;">
            <!-- Calculating state -->
            <div class="calc-wrap" id="calcWrap">
                <div class="calc-spinner"></div>
                <h2>Building your plan...</h2>
                <p class="subtitle" style="margin-top: 8px;">Analyzing your answers</p>
            </div>
            <!-- Result (hidden initially) -->
            <div id="planResult" style="display: none; width: 100%; flex-direction: column; align-items: center;">
                <img src="../ninja-poses/ninja-thumbsup.png" alt="Ninja" class="ninja-img small">
                <h2 id="planTitle">Here's your plan</h2>
                <p class="subtitle">We created this based on your answers. You can customize it next.</p>
                <div class="plan-card" id="planCard"></div>
                <button class="btn-primary" onclick="goNext()">Customize My Plan</button>
            </div>
        </div>

        <!-- ==================== SCREEN 8: CUSTOMIZE GOAL ==================== -->
        <div class="screen scrollable" id="screen8">
            <h2>Customize Your Goal</h2>
            <p class="subtitle">Edit anything — make it yours.</p>

            <!-- Icon Section -->
            <div class="icon-section animate-in">
                <div class="mission-icon-large" onclick="changeGoalIcon()">
                    <span id="screen8GoalIcon"></span>
                    <div class="edit-icon-badge">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                    </div>
                </div>
                <span class="change-icon-text">Tap to change icon</span>
            </div>

            <!-- Goal Name -->
            <div class="form-group animate-in delay-1">
                <div class="form-label">
                    Goal Name
                    <span class="form-label-hint">Required</span>
                </div>
                <div class="form-card">
                    <div class="input-field">
                        <input type="text" id="customGoalName" placeholder="e.g., Exercise for 30 minutes" maxlength="40">
                    </div>
                </div>
            </div>

            <!-- Description -->
            <div class="form-group animate-in delay-1">
                <div class="form-label">
                    Description
                    <span class="form-label-hint">Optional</span>
                </div>
                <div class="form-card">
                    <div class="input-field">
                        <textarea id="customGoalDesc" placeholder="Add notes about your goal..." rows="2"></textarea>
                    </div>
                </div>
            </div>

            <!-- Habits -->
            <div class="form-group animate-in delay-2">
                <div class="form-label">
                    Habits
                    <span class="form-label-hint">Daily actions toward this goal</span>
                </div>
                <div id="habitsEditList"></div>
                <button class="add-habit-btn" onclick="addHabitRow()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    Add Another Habit
                </button>
            </div>

            <!-- Duration -->
            <div class="form-group animate-in delay-2">
                <div class="form-label">Duration</div>
                <div class="form-card">
                    <div class="duration-options" id="durationRow">
                        <div class="duration-option" data-dur="7" onclick="selectDuration(this)">
                            <div class="duration-days">7</div>
                            <div class="duration-label">days</div>
                        </div>
                        <div class="duration-option selected" data-dur="30" onclick="selectDuration(this)">
                            <div class="duration-days">30</div>
                            <div class="duration-label">days</div>
                        </div>
                        <div class="duration-option" data-dur="90" onclick="selectDuration(this)">
                            <div class="duration-days">90</div>
                            <div class="duration-label">days</div>
                        </div>
                        <div class="duration-option no-end" data-dur="0" onclick="selectDuration(this)">
                            <div class="duration-days">&infin;</div>
                            <div class="duration-label">ongoing</div>
                        </div>
                    </div>
                    <div class="custom-row">
                        <span class="custom-label">Or custom:</span>
                        <div class="custom-input-wrap">
                            <input type="number" class="custom-input" id="customDurationInput" placeholder="Enter days" oninput="selectCustomDuration(this.value)" onclick="event.stopPropagation()">
                            <span class="custom-suffix">days</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Target -->
            <div class="form-group animate-in delay-3">
                <div class="form-label">Target Completion Rate</div>
                <div class="form-card">
                    <div class="target-section">
                        <div class="target-display">
                            <div class="target-value-lg" id="targetValue">80%</div>
                            <div class="target-desc" id="targetDesc">Maintain <strong>80%</strong> completion to keep savings unlocked</div>
                        </div>
                        <input type="range" class="target-slider" id="targetSlider" min="50" max="100" value="80" oninput="updateTargetLabel()">
                    </div>
                </div>
            </div>

            <!-- Settings -->
            <div class="form-group animate-in delay-3">
                <div class="form-label">Settings</div>
                <div class="form-card">
                    <div class="selector-field">
                        <span class="selector-label">Daily Reminder</span>
                        <span class="selector-value" id="onbReminderDisplay">
                            9:00 PM
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="16" height="16"><polyline points="9 18 15 12 9 6"/></svg>
                        </span>
                        <input type="time" id="onbReminderInput" value="21:00" style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer;z-index:2;" onchange="onOnbReminderChange(this.value)">
                    </div>
                    <div class="selector-field">
                        <span class="selector-label">Start Date</span>
                        <span class="selector-value" id="onbStartDateDisplay">
                            Today
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="16" height="16"><polyline points="9 18 15 12 9 6"/></svg>
                        </span>
                        <input type="date" id="onbStartDateInput" style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer;z-index:2;" onchange="onOnbStartDateChange(this.value)">
                    </div>
                </div>
            </div>

            <!-- Summary -->
            <div class="form-group animate-in delay-4">
                <div class="summary-card" id="onbSummaryCard">
                    <div class="summary-title">Goal Summary</div>
                    <div class="summary-row">
                        <span class="s-label">Habits</span>
                        <span class="s-value" id="onbSummaryHabitCount">1 habit</span>
                    </div>
                    <div class="summary-row">
                        <span class="s-label">Penalty per check-in</span>
                        <span class="s-value" id="onbMaxDailyPenalty">$5</span>
                    </div>
                    <div class="summary-row">
                        <span class="s-label">Max total penalty</span>
                        <span class="s-value" id="onbMaxPenalty">$150.00</span>
                    </div>
                </div>
            </div>

            <!-- Info Tip -->
            <div class="info-tip animate-in delay-4">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="16" x2="12" y2="12"/>
                    <line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
                <p>You can edit any of these settings — the template is just a starting point. Make it yours, ninja!</p>
            </div>

            <!-- Bottom CTA -->
            <div class="bottom-cta">
                <button class="start-btn" onclick="createGoalAndContinue()">Finalize Goal</button>
            </div>
        </div>

        <!-- ==================== SCREEN 9: COMMITMENT ==================== -->
        <div class="screen" id="screen9">
            <img src="../ninja-poses/ninja-focus.png" alt="Ninja" class="ninja-img small">
            <h2 id="commitTitle">Make it official</h2>
            <p class="subtitle">Your commitment to yourself</p>
            <div class="commit-list">
                <div class="commit-item checked" onclick="toggleCommit(this)">
                    <div class="commit-check">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                    </div>
                    <span class="commit-text">I'll check in on my habits daily</span>
                </div>
                <div class="commit-item checked" onclick="toggleCommit(this)">
                    <div class="commit-check">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                    </div>
                    <span class="commit-text">I understand missed habits add to my savings</span>
                </div>
                <div class="commit-item checked" onclick="toggleCommit(this)">
                    <div class="commit-check">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                    </div>
                    <span class="commit-text">I'm ready to build habits that stick</span>
                </div>
            </div>
            <button class="btn-primary" onclick="goNext()">I'm Ready</button>
        </div>

        <!-- ==================== SCREEN 10: PAYMENT SETUP ==================== -->
        <div class="screen" id="screen10">
            <img src="../ninja-poses/ninja-coin.png" alt="Ninja" class="ninja-img small">
            <h2>Enable accountability</h2>
            <p class="subtitle">Connect a payment method to activate stakes.</p>

            <div class="payment-card">
                <div class="payment-title">Why connect payment?</div>
                <div class="payment-desc">Without real stakes, this is just another habit tracker. With stakes, your success rate jumps to 95%.</div>

                <div class="payment-benefits">
                    <div class="benefit-item">
                        <svg class="benefit-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                        <span class="benefit-text">Only charged when you miss a day</span>
                    </div>
                    <div class="benefit-item">
                        <svg class="benefit-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                        <span class="benefit-text">Money goes to YOUR savings</span>
                    </div>
                    <div class="benefit-item">
                        <svg class="benefit-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                        <span class="benefit-text">Withdraw anytime (small fee if early)</span>
                    </div>
                    <div class="benefit-item">
                        <svg class="benefit-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                        <span class="benefit-text">Secured by Stripe</span>
                    </div>
                </div>

                <button class="connect-btn" onclick="savePaymentIntent(true); goNext()">Connect Payment Method</button>
                <button class="skip-payment-btn" onclick="savePaymentIntent(false); goNext()">I'll do this later</button>
            </div>
        </div>

        <!-- ==================== SCREEN 12: SUCCESS ==================== -->
        <div class="screen" id="screen12">
            <img src="../ninja-poses/ninja-thumbsup.png" alt="Ninja" class="ninja-img" id="successNinja">
            <h1 id="successTitle">You're all set! 🎉</h1>
            <p class="subtitle">Your first goal is live. Let's make it count.</p>
            <div class="summary-card" id="summaryCard"></div>
            <button class="btn-primary" onclick="goNext()">Start Day 1 →</button>
        </div>

        <!-- ==================== SCREEN 13: QUICK WIN ==================== -->
        <div class="screen scrollable" id="screen13">
            <img src="../ninja-poses/ninja-streak.png" alt="Ninja" class="ninja-img small" id="qwNinja">
            <h2>One last thing — let's start strong</h2>
            <p class="subtitle" id="qwSubtitle">Check in on today's habits to get your first win!</p>
            <div id="qwHabitsList" style="width: 100%; max-width: 340px;"></div>
            <button class="btn-primary" onclick="finishOnboarding()">Go to Dashboard →</button>
        </div>

    </div><!-- /carousel -->

    <!-- Habit Icon Picker Modal -->
    <div class="habit-icon-picker-overlay" id="habitIconPickerOverlay" onclick="closeHabitIconPicker(event)">
        <div class="habit-icon-picker-modal">
            <div class="habit-icon-picker-handle"></div>
            <div class="habit-icon-picker-title">Choose Icon</div>
            <div class="habit-icon-picker-grid" id="habitIconPickerGrid"></div>
        </div>
    </div>

    <!-- Goal Icon Picker Modal -->
    <div id="goalIconPickerOverlay" onclick="closeGoalIconPicker(event)">
        <div style="background:#fff;border-radius:24px 24px 0 0;padding:20px 20px 32px;width:100%;max-width:390px;transform:translateY(0);transition:transform 0.3s ease;">
            <div style="width:36px;height:4px;background:#ddd;border-radius:2px;margin:0 auto 16px;"></div>
            <div style="font-size:17px;font-weight:700;text-align:center;margin-bottom:20px;">Choose an Icon</div>
            <div id="goalIconPickerGrid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;"></div>
        </div>
    </div>

</div><!-- /phone-frame -->

<script>
// ============================
// STATE
// ============================
var currentScreen = 0;
var totalScreens = 13;
var userName = '';
var userGoalAreas = [];
var userExperience = '';
var userPainPoints = [];
var selectedIcon = 'target';
var selectedDuration = 30;
var selectedReminder = '21:00';
var selectedStartDate = '';
var createdGoalId = null;
var createdHabitIds = [];
var activeHabitIconTarget = null;

// Goal templates by area
var goalTemplates = {
    fitness:     { name: 'Fitness Challenge',    icon: 'exercise', emoji: '🏋️', habits: [{ name: 'Morning Workout', icon: 'exercise', penalty: 5 }, { name: 'Drink 2L Water', icon: 'water', penalty: 3 }, { name: 'No Junk Food', icon: 'food', penalty: 5 }] },
    learning:    { name: 'Learning Sprint',      icon: 'book',     emoji: '📚', habits: [{ name: 'Study 30 Min', icon: 'book', penalty: 5 }, { name: 'Read 20 Pages', icon: 'book', penalty: 3 }] },
    saving:      { name: 'Money Saver',          icon: 'money',    emoji: '💰', habits: [{ name: 'Pack Lunch', icon: 'money', penalty: 10 }, { name: 'No Impulse Buys', icon: 'shopping', penalty: 5 }] },
    mindfulness: { name: 'Mindfulness Journey',  icon: 'meditation', emoji: '🧘', habits: [{ name: 'Meditate 10 Min', icon: 'meditation', penalty: 3 }, { name: 'No Phone Before Bed', icon: 'phone', penalty: 5 }] },
    breaking:    { name: 'Digital Detox',        icon: 'phone',    emoji: '📵', habits: [{ name: 'No Social Media', icon: 'phone', penalty: 5 }, { name: 'No TikTok', icon: 'phone', penalty: 5 }] },
    routine:     { name: 'Morning Routine',      icon: 'sun',      emoji: '✨', habits: [{ name: 'Wake Up Early', icon: 'sun', penalty: 5 }, { name: 'Make Bed', icon: 'target', penalty: 2 }, { name: 'Healthy Breakfast', icon: 'food', penalty: 3 }] },
    productivity: { name: 'Productivity Boost',  icon: 'target',   emoji: '⚡', habits: [{ name: 'Deep Work 1 Hour', icon: 'target', penalty: 5 }, { name: 'No Social Media During Work', icon: 'phone', penalty: 5 }] },
    wellness:    { name: 'Health & Wellness',    icon: 'water',    emoji: '❤️', habits: [{ name: 'Sleep by 10:30pm', icon: 'sleep', penalty: 5 }, { name: 'Eat a Healthy Meal', icon: 'food', penalty: 3 }, { name: 'Take Vitamins', icon: 'water', penalty: 2 }] }
};

// Available icons for icon picker
var iconIds = ['target', 'exercise', 'book', 'money', 'meditation', 'phone', 'food', 'water', 'sun', 'sleep', 'coffee', 'shopping'];

// ============================
// NAVIGATION
// ============================
function goTo(idx) {
    if (idx < 0 || idx >= totalScreens) return;
    currentScreen = idx;
    document.getElementById('carousel').style.transform = 'translateX(-' + (currentScreen * 100) + '%)';
    
    // Progress bar
    var pct = ((currentScreen) / (totalScreens - 1)) * 100;
    document.getElementById('progressFill').style.width = pct + '%';
    
    // Back button: hide only on first screen
    var backBtn = document.getElementById('backBtn');
    if (currentScreen === 0) {
        backBtn.classList.add('hidden');
    } else {
        backBtn.classList.remove('hidden');
    }


    // Screen-specific triggers
    if (currentScreen === 7) triggerPlanAnimation();
    if (currentScreen === 11) triggerSuccess();
}

function goNext() { goTo(currentScreen + 1); }
function goBack() { goTo(currentScreen - 1); }

// ============================
// SCREEN 2: NAME
// ============================
function onNameInput() {
    var val = document.getElementById('nameInput').value.trim();
    document.getElementById('nameContinueBtn').disabled = val.length === 0;
}

function saveName() {
    userName = document.getElementById('nameInput').value.trim() || 'Ninja';
    localStorage.setItem('goalNinjaUserName', userName);
    applyName();
}


function applyName() {
    // Update dynamic name references
    document.getElementById('goalAreaTitle').textContent = 'Alright ' + userName + ', let\'s dive into your goals';
    document.getElementById('commitTitle').textContent = 'Make it official, ' + userName;
    document.getElementById('planTitle').textContent = userName + ', here\'s your plan';
    document.getElementById('successTitle').textContent = 'You\'re all set, ' + userName + '! 🎉';
}

// ============================
// SCREEN 3: GOAL AREAS
// ============================
function toggleArea(card) {
    card.classList.toggle('selected');
    userGoalAreas = [];
    document.querySelectorAll('#goalAreaGrid .select-card.selected').forEach(function(c) {
        userGoalAreas.push(c.dataset.area);
    });
    document.getElementById('goalAreaBtn').disabled = userGoalAreas.length === 0;
}

// ============================
// SCREEN 4: EXPERIENCE
// ============================
function selectExp(card) {
    document.querySelectorAll('#expGrid .select-card').forEach(function(c) { c.classList.remove('selected'); });
    card.classList.add('selected');
    userExperience = card.dataset.exp;
    document.getElementById('expBtn').disabled = false;

    // Dynamic ninja response
    var resp = document.getElementById('expResponse');
    var ninja = document.getElementById('expNinja');
    if (userExperience === 'new') {
        resp.textContent = "We'll make this easy for you! 🙌";
        ninja.src = '../ninja-poses/ninja-wealth.png';
    } else if (userExperience === 'tried') {
        resp.textContent = 'This time will be different! 💪';
        ninja.src = '../ninja-poses/ninja-thumbsup.png';
    } else {
        resp.textContent = "Let's level up together! ⚔️";
        ninja.src = '../ninja-poses/ninja-action.png';
    }
    resp.classList.add('visible');
}

// ============================
// SCREEN 5: PAIN POINTS
// ============================
function togglePain(card) {
    card.classList.toggle('selected');
    var wasSelected = card.classList.contains('selected');
    userPainPoints = [];
    document.querySelectorAll('#painGrid .select-card.selected').forEach(function(c) {
        userPainPoints.push(c.dataset.pain);
    });
    document.getElementById('painBtn').disabled = userPainPoints.length === 0;

    // Dynamic ninja response
    var resp = document.getElementById('painResponse');
    var ninja = document.getElementById('painNinja');
    if (wasSelected) {
        var pain = card.dataset.pain;
        if (pain === 'motivation') {
            resp.textContent = "That's what stakes are for! 🔥";
            ninja.src = '../ninja-poses/ninja-action.png';
        } else if (pain === 'streak') {
            resp.textContent = "We use targets, not streaks! 🎯";
            ninja.src = '../ninja-poses/ninja-thumbsup.png';
        } else if (pain === 'consequences') {
            resp.textContent = "Real stakes change everything! 💰";
            ninja.src = '../ninja-poses/ninja-wealth.png';
        } else if (pain === 'forget') {
            resp.textContent = "I'll remind you! ⏰";
            ninja.src = '../ninja-poses/ninja-alarm.png';
        }
        resp.classList.add('visible');
    }
}

// ============================
// SCREEN 7: PLAN ANIMATION
// ============================
function triggerPlanAnimation() {
    var calcWrap = document.getElementById('calcWrap');
    var planResult = document.getElementById('planResult');
    calcWrap.classList.remove('hidden');
    planResult.style.display = 'none';

    setTimeout(function() {
        calcWrap.classList.add('hidden');
        planResult.style.display = 'flex';
        buildPlanCard();
    }, 2500);
}

function buildPlanCard() {
    var primary = userGoalAreas[0] || 'fitness';
    var template = goalTemplates[primary];
    selectedIcon = template.icon;
    
    var totalPenalty = 0;
    template.habits.forEach(function(h) { totalPenalty += h.penalty; });

    var html = '<div class="plan-header">';
    html += '<div class="plan-icon">' + template.emoji + '</div>';
    html += '<div class="plan-name">' + template.name + '</div>';
    html += '</div>';
    html += '<div class="plan-detail"><span class="plan-label">Duration</span><span class="plan-value">30 days</span></div>';
    html += '<div class="plan-detail"><span class="plan-label">Target</span><span class="plan-value">80%</span></div>';
    html += '<div class="plan-detail"><span class="plan-label">Check-ins</span><span class="plan-value">$' + totalPenalty + '/day</span></div>';
    html += '<div class="plan-habits-list">';
    template.habits.forEach(function(h) {
        html += '<div class="plan-habit-item"><span class="plan-habit-name">' + h.name + '</span><span class="plan-habit-penalty-badge">$' + h.penalty + '</span></div>';
    });
    html += '</div>';

    if (userGoalAreas.length > 1) {
        var others = userGoalAreas.slice(1).map(function(a) { return goalTemplates[a] ? goalTemplates[a].name : a; }).join(', ');
        html += '<p style="font-size:12px; color:var(--text-secondary); margin-top:12px; text-align:center;">You can edit habits and details at any time.</p>';
    }

    document.getElementById('planCard').innerHTML = html;
    
    // Pre-fill customize screen
    prefillCustomize(primary);
    setTimeout(updateOnbSummary, 100);
}

// ============================
// SCREEN 8: CUSTOMIZE
// ============================
function prefillCustomize(area) {
    var template = goalTemplates[area];
    document.getElementById('customGoalName').value = template.name;
    selectedIcon = template.icon;

    // Set large centered icon
    var iconContainer = document.getElementById('screen8GoalIcon');
    if (iconContainer) {
        iconContainer.innerHTML = GN_getIconSVG(selectedIcon, 40);
    }

    // Build habits list
    var habitsHtml = '';
    template.habits.forEach(function(h, i) {
        habitsHtml += buildHabitEditRow(h.name, h.penalty, h.icon, i, h.frequency || 'daily');
    });
    document.getElementById('habitsEditList').innerHTML = habitsHtml;

    // Set start date min
    var dateInput = document.getElementById('onbStartDateInput');
    if (dateInput) {
        var today = GN_getTodayDateStr();
        dateInput.min = today;
        dateInput.value = today;
    }

    updateOnbSummary();
}

// ---- Frequency helpers ----
function parseFrequencyOnboarding(freq) {
    if (!freq || freq === 'daily') return { num: 1, unit: 'days' };
    if (freq === 'weekly') return { num: 1, unit: 'weeks' };
    if (freq === 'monthly') return { num: 1, unit: 'months' };
    var m = (freq || '').match(/^every(\d+)(days|weeks|months)$/);
    if (m) return { num: parseInt(m[1]), unit: m[2] };
    return { num: 1, unit: 'days' };
}

function buildFrequencyStringOnboarding(num, unit) {
    num = parseInt(num) || 1;
    if (num === 1 && unit === 'days') return 'daily';
    if (num === 1 && unit === 'weeks') return 'weekly';
    if (num === 1 && unit === 'months') return 'monthly';
    return 'every' + num + unit;
}

// ---- Habit Icon Picker ----
var habitIconList = [
    {id: 'target', label: 'Target'}, {id: 'exercise', label: 'Exercise'},
    {id: 'book', label: 'Reading'}, {id: 'meditation', label: 'Meditate'},
    {id: 'money', label: 'Finance'}, {id: 'coffee', label: 'Coffee'},
    {id: 'sleep', label: 'Sleep'}, {id: 'water', label: 'Water'},
    {id: 'food', label: 'Food'}, {id: 'sun', label: 'Wellness'},
    {id: 'phone', label: 'Screen'}, {id: 'shopping', label: 'Shopping'}
];

function openHabitIconPicker(iconDiv) {
    activeHabitIconTarget = iconDiv;
    var currentIcon = iconDiv.dataset.icon || 'target';
    var grid = document.getElementById('habitIconPickerGrid');
    var html = '';
    habitIconList.forEach(function(icon) {
        var sel = icon.id === currentIcon ? ' selected' : '';
        html += '<div class="habit-icon-pick-item' + sel + '" onclick="selectHabitIcon(\'' + icon.id + '\')">' +
            '<div class="habit-icon-pick-circle">' + GN_getIconSVG(icon.id, 22) + '</div>' +
            '<span class="habit-icon-pick-label">' + icon.label + '</span>' +
            '</div>';
    });
    grid.innerHTML = html;
    document.getElementById('habitIconPickerOverlay').classList.add('active');
}

function selectHabitIcon(iconId) {
    if (activeHabitIconTarget) {
        activeHabitIconTarget.dataset.icon = iconId;
        activeHabitIconTarget.innerHTML = GN_getIconSVG(iconId, 20);
        var formCard = activeHabitIconTarget.closest('.habit-form-card');
        if (formCard) {
            var nameInput = formCard.querySelector('.habit-name-input');
            if (nameInput) nameInput.dataset.icon = iconId;
        }
    }
    closeHabitIconPicker();
}

function closeHabitIconPicker(e) {
    if (e && e.target !== document.getElementById('habitIconPickerOverlay')) return;
    document.getElementById('habitIconPickerOverlay').classList.remove('active');
    activeHabitIconTarget = null;
}

// ---- Goal Icon Picker ----
function changeGoalIcon() {
    var grid = document.getElementById('goalIconPickerGrid');
    grid.innerHTML = '';
    iconIds.forEach(function(id) {
        var sel = id === selectedIcon ? ' style="border:2px solid #1a1a1a;border-radius:12px;"' : ' style="border:2px solid transparent;border-radius:12px;"';
        var item = document.createElement('div');
        item.setAttribute('style', 'display:flex;flex-direction:column;align-items:center;padding:10px;cursor:pointer;' + (id === selectedIcon ? 'border:2px solid #1a1a1a;border-radius:12px;' : 'border:2px solid transparent;border-radius:12px;'));
        item.onclick = function() { selectGoalIcon(id); };
        var label = (habitIconList.find(function(h){return h.id===id;}) || {label:id}).label;
        item.innerHTML = '<div style="width:40px;height:40px;background:#f5f5f5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:4px;">' + GN_getIconSVG(id, 22) + '</div>' +
            '<span style="font-size:10px;color:#6b6b6b;text-transform:capitalize;">' + label + '</span>';
        grid.appendChild(item);
    });
    document.getElementById('goalIconPickerOverlay').classList.add('active');
}

function selectGoalIcon(iconId) {
    selectedIcon = iconId;
    var container = document.getElementById('screen8GoalIcon');
    if (container) container.innerHTML = GN_getIconSVG(selectedIcon, 40);
    closeGoalIconPicker();
}

function closeGoalIconPicker(e) {
    if (e && e.target !== document.getElementById('goalIconPickerOverlay')) return;
    document.getElementById('goalIconPickerOverlay').classList.remove('active');
}

function selectCustomDuration(value) {
    if (value && parseInt(value) > 0) {
        document.querySelectorAll('#durationRow .duration-option').forEach(function(el) { el.classList.remove('selected'); });
        selectedDuration = parseInt(value);
        updateOnbSummary();
    }
}

// ---- Reminder & Start Date ----
function onOnbReminderChange(val) {
    if (!val) return;
    selectedReminder = val;
    var parts = val.split(':');
    var h = parseInt(parts[0]);
    var m = parts[1];
    var ampm = h >= 12 ? 'PM' : 'AM';
    var h12 = h % 12 || 12;
    document.getElementById('onbReminderDisplay').innerHTML = h12 + ':' + m + ' ' + ampm + ' <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="16" height="16"><polyline points="9 18 15 12 9 6"/></svg>';
}

function onOnbStartDateChange(val) {
    if (!val) return;
    selectedStartDate = val;
    var today = GN_getTodayDateStr();
    var label = 'Today';
    if (val !== today) {
        var d = new Date(val + 'T12:00:00');
        var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        label = months[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear();
    }
    document.getElementById('onbStartDateDisplay').innerHTML = label + ' <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="16" height="16"><polyline points="9 18 15 12 9 6"/></svg>';
}

// ---- Habit Row Builder ----
function buildHabitEditRow(name, penalty, icon, idx, frequency) {
    var parsed = parseFrequencyOnboarding(frequency || 'daily');
    var safeName = (name || '').replace(/"/g, '&quot;');
    return '<div class="habit-form-card" data-idx="' + idx + '">' +
        '<div class="habit-form-row">' +
        '<div class="habit-form-icon" data-icon="' + icon + '" onclick="openHabitIconPicker(this)">' + GN_getIconSVG(icon, 20) + '</div>' +
        '<div class="habit-form-fields">' +
        '<input type="text" class="habit-name-input" placeholder="Habit name (e.g., 100 push-ups)" value="' + safeName + '" data-icon="' + icon + '">' +
        '<div class="habit-penalty-row"><span>Penalty: $</span><input type="number" class="habit-penalty-input" value="' + penalty + '" min="1" max="100" onchange="updateOnbSummary()"></div>' +
        '<div class="habit-freq-row">' +
        '<span class="freq-label">Every</span>' +
        '<input type="number" class="habit-freq-num" value="' + parsed.num + '" min="1" max="365" onchange="updateOnbSummary()">' +
        '<select class="habit-freq-unit" onchange="updateOnbSummary()">' +
        '<option value="days"' + (parsed.unit === 'days' ? ' selected' : '') + '>day(s)</option>' +
        '<option value="weeks"' + (parsed.unit === 'weeks' ? ' selected' : '') + '>week(s)</option>' +
        '<option value="months"' + (parsed.unit === 'months' ? ' selected' : '') + '>month(s)</option>' +
        '</select>' +
        '</div>' +
        '</div>' +
        '</div>' +
        '<button class="remove-habit-btn" onclick="removeHabitRow(this)" title="Remove"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>' +
        '</div>';
}

function addHabitRow() {
    var list = document.getElementById('habitsEditList');
    var idx = list.children.length;
    var html = buildHabitEditRow('', 5, 'target', idx, 'daily');
    list.insertAdjacentHTML('beforeend', html);
    updateOnbSummary();
}

function removeHabitRow(btn) {
    var item = btn.closest('.habit-form-card');
    if (document.getElementById('habitsEditList').children.length > 1) {
        item.remove();
        updateOnbSummary();
    }
}

function selectDuration(el) {
    document.querySelectorAll('#durationRow .duration-option').forEach(function(p) { p.classList.remove('selected'); });
    el.classList.add('selected');
    selectedDuration = parseInt(el.dataset.dur);
    var customInput = document.getElementById('customDurationInput');
    if (customInput) customInput.value = '';
    updateOnbSummary();
}

function updateTargetLabel() {
    var val = document.getElementById('targetSlider').value;
    document.getElementById('targetValue').textContent = val + '%';
    var descEl = document.getElementById('targetDesc');
    if (descEl) {
        descEl.innerHTML = 'Maintain <strong>' + val + '%</strong> completion to keep savings unlocked';
    }
}

function updateOnbSummary() {
    var habitCards = document.querySelectorAll('#habitsEditList .habit-form-card');
    var habitCount = 0;
    var totalPerOccurrence = 0;
    var totalOverDuration = 0;

    habitCards.forEach(function(card) {
        var nameInput = card.querySelector('.habit-name-input');
        var penaltyInput = card.querySelector('.habit-penalty-input');
        var freqNum = card.querySelector('.habit-freq-num');
        var freqUnit = card.querySelector('.habit-freq-unit');
        var penalty = parseFloat(penaltyInput ? penaltyInput.value : 0) || 0;

        habitCount++;
        totalPerOccurrence += penalty;
        if (selectedDuration > 0 && freqNum && freqUnit) {
            var freq = buildFrequencyStringOnboarding(parseInt(freqNum.value) || 1, freqUnit.value);
            totalOverDuration += penalty * GN_getFrequencyMultiplier(freq, selectedDuration);
        } else if (selectedDuration > 0) {
            totalOverDuration += penalty * selectedDuration;
        }
    });

    var el = document.getElementById('onbSummaryHabitCount');
    if (el) el.textContent = habitCount + ' habit' + (habitCount !== 1 ? 's' : '');

    var dailyEl = document.getElementById('onbMaxDailyPenalty');
    if (dailyEl) dailyEl.textContent = '$' + totalPerOccurrence;

    var maxEl = document.getElementById('onbMaxPenalty');
    if (maxEl) {
        if (selectedDuration === 0) {
            maxEl.textContent = 'Ongoing';
        } else {
            maxEl.textContent = '$' + totalOverDuration.toFixed(2);
        }
    }
}

function createGoalAndContinue() {
    var goalName = document.getElementById('customGoalName').value.trim() || 'My Goal';
    var goalDesc = document.getElementById('customGoalDesc') ? document.getElementById('customGoalDesc').value.trim() : '';
    var target = parseInt(document.getElementById('targetSlider').value) || 80;

    // Validate at least one habit
    var habitCards = document.querySelectorAll('#habitsEditList .habit-form-card');
    var validHabits = [];
    habitCards.forEach(function(card) {
        var hName = card.querySelector('.habit-name-input').value.trim();
        if (hName) validHabits.push(card);
    });
    if (validHabits.length === 0) {
        alert('Please add at least one habit');
        return;
    }

    // Create goal
    var goalData = {
        name: goalName,
        icon: selectedIcon,
        description: goalDesc,
        duration: selectedDuration,
        target: target
    };
    if (selectedStartDate) goalData.startDate = selectedStartDate;

    var goal = GN_addGoal(goalData);
    createdGoalId = goal.id;
    createdHabitIds = [];

    // Create habits
    validHabits.forEach(function(card) {
        var nameInput = card.querySelector('.habit-name-input');
        var penaltyInput = card.querySelector('.habit-penalty-input');
        var freqNum = card.querySelector('.habit-freq-num');
        var freqUnit = card.querySelector('.habit-freq-unit');
        var hName = nameInput.value.trim();
        var hPenalty = parseFloat(penaltyInput.value) || 5;
        var hIcon = nameInput.dataset.icon || 'target';
        var freq = 'daily';
        if (freqNum && freqUnit) {
            freq = buildFrequencyStringOnboarding(parseInt(freqNum.value) || 1, freqUnit.value);
        }

        var habit = GN_addHabit({
            name: hName,
            icon: hIcon,
            penalty: hPenalty,
            frequency: freq,
            reminder: selectedReminder,
            goalIds: [goal.id]
        });
        createdHabitIds.push(habit.id);
    });

    goNext();
}

// ============================
// SCREEN 9: COMMITMENT
// ============================
function toggleCommit(item) {
    item.classList.toggle('checked');
}

// ============================
// SCREEN 10: PAYMENT
// ============================
function savePaymentIntent(wantsPayment) {
    localStorage.setItem('goalNinjaPaymentIntent', wantsPayment ? 'true' : 'false');
}

// ============================
// SCREEN 11: PRO
// ============================
function proInterest(interested) {
    localStorage.setItem('goalNinjaProInterest', interested ? 'true' : 'false');
}

// ============================
// SCREEN 12: SUCCESS
// ============================
function triggerSuccess() {
    try {
        var goalName = 'My Goal';
        var habitCount = 0;
        var totalPenalty = 0;
        var duration = selectedDuration || 30;
        var goalIcon = selectedIcon || 'target';

        // Try reading from the actual created goal in localStorage
        if (createdGoalId) {
            try {
                var goals = JSON.parse(localStorage.getItem('goalNinjaGoals') || '[]');
                for (var i = 0; i < goals.length; i++) {
                    if (goals[i].id === createdGoalId) {
                        goalName = goals[i].name || goalName;
                        duration = goals[i].duration || duration;
                        goalIcon = goals[i].icon || goalIcon;
                        break;
                    }
                }
                var habits = JSON.parse(localStorage.getItem('goalNinjaHabits') || '[]');
                for (var j = 0; j < habits.length; j++) {
                    if (habits[j].goalIds && habits[j].goalIds.indexOf(createdGoalId) !== -1) {
                        habitCount++;
                        totalPenalty += (habits[j].penalty || 0);
                    }
                }
            } catch(e) { console.log('triggerSuccess localStorage read error:', e); }
        }

        // Fallback: try reading from Screen 8 DOM
        if (habitCount === 0) {
            try {
                var habitCards = document.querySelectorAll('#habitsEditList .habit-form-card');
                for (var k = 0; k < habitCards.length; k++) {
                    var penaltyEl = habitCards[k].querySelector('.habit-penalty-input');
                    totalPenalty += parseFloat(penaltyEl ? penaltyEl.value : 0) || 0;
                    habitCount++;
                }
            } catch(e) { console.log('triggerSuccess DOM read error:', e); }
        }

        // Fallback: use goal name from Screen 8 input
        if (goalName === 'My Goal') {
            var nameInput = document.getElementById('customGoalName');
            if (nameInput && nameInput.value && nameInput.value.trim()) {
                goalName = nameInput.value.trim();
            }
        }

        // Use createdHabitIds length as fallback for count
        if (habitCount === 0 && createdHabitIds && createdHabitIds.length > 0) {
            habitCount = createdHabitIds.length;
        }

        var durationText = duration > 0 ? duration + 'd' : 'Ongoing';
        var iconHtml = '';
        try { iconHtml = GN_getIconSVG(goalIcon, 28); } catch(e) { iconHtml = '🎯'; }

        var card = document.getElementById('summaryCard');
        if (card) {
            card.innerHTML = '<div class="summary-icon">' + iconHtml + '</div>' +
                '<div class="summary-goal-name">' + goalName + '</div>' +
                '<div class="summary-stats">' +
                '<div class="summary-stat"><div class="summary-stat-value">' + habitCount + '</div><div class="summary-stat-label">Habits</div></div>' +
                '<div class="summary-stat"><div class="summary-stat-value">' + durationText + '</div><div class="summary-stat-label">Duration</div></div>' +
                '<div class="summary-stat"><div class="summary-stat-value">$' + totalPenalty + '</div><div class="summary-stat-label">Per Day</div></div>' +
                '</div>';
        }
    } catch(e) {
        console.log('triggerSuccess error:', e);
        var card = document.getElementById('summaryCard');
        if (card) {
            card.innerHTML = '<div class="summary-goal-name">Your goal is ready!</div>' +
                '<div class="summary-stats">' +
                '<div class="summary-stat"><div class="summary-stat-value">✓</div><div class="summary-stat-label">Created</div></div>' +
                '</div>';
        }
    }

    // Build quick-win habits for screen 13
    try { buildQuickWin(); } catch(e) { console.log('buildQuickWin error:', e); }

    // Fire confetti
    try { launchConfetti(); } catch(e) { console.log('launchConfetti error:', e); }
}

// ============================
// CONFETTI
// ============================
function launchConfetti() {
    var container = document.createElement('div');
    container.className = 'confetti-container';
    document.body.appendChild(container);
    var colors = ['#E67E22', '#22c55e', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6'];
    for (var i = 0; i < 60; i++) {
        var piece = document.createElement('div');
        piece.className = 'confetti';
        piece.style.left = Math.random() * 100 + '%';
        piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        piece.style.animationDelay = Math.random() * 2 + 's';
        piece.style.animationDuration = (2 + Math.random() * 2) + 's';
        piece.style.width = (6 + Math.random() * 8) + 'px';
        piece.style.height = (8 + Math.random() * 10) + 'px';
        container.appendChild(piece);
    }
    setTimeout(function() { container.remove(); }, 5000);
}

// ============================
// SCREEN 13: QUICK WIN
// ============================
function buildQuickWin() {
    var habits = GN_getHabits();
    var html = '';
    createdHabitIds.forEach(function(hid) {
        var habit = habits.find(function(h) { return h.id === hid; });
        if (!habit) return;
        html += '<div class="qw-habit" id="qw-' + hid + '">';
        html += '<div class="qw-habit-info">';
        html += '<span style="display:flex;align-items:center;">' + GN_getIconSVG(habit.icon, 20) + '</span>';
        html += '<span class="qw-habit-name">' + habit.name + '</span>';
        html += '</div>';
        html += '<button class="qw-check-btn" onclick="quickCheckin(\'' + hid + '\', this)">';
        html += '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>';
        html += '</button>';
        html += '</div>';
    });
    document.getElementById('qwHabitsList').innerHTML = html;
}

function quickCheckin(habitId, btn) {
    var row = document.getElementById('qw-' + habitId);
    if (row.classList.contains('done')) {
        row.classList.remove('done');
        var c = JSON.parse(localStorage.getItem('goalNinjaCheckins')||'{}');
        if (c[habitId]) { delete c[habitId][GN_getTodayDateStr()]; }
        localStorage.setItem('goalNinjaCheckins', JSON.stringify(c));
        document.getElementById('qwNinja').src = '../ninja-poses/ninja-streak.png';
        document.getElementById('qwSubtitle').textContent = "Check in on today's habits to get your first win!";
        return;
    }
    
    GN_recordHabitCheckin(habitId, GN_getTodayDateStr(), 'completed');
    row.classList.add('done');

    // Ninja reaction
    var ninja = document.getElementById('qwNinja');
    ninja.src = '../ninja-poses/ninja-thumbsup.png';
    var sub = document.getElementById('qwSubtitle');
    sub.textContent = "That's the way, " + userName + "! 🔥";
}

// ============================
// FINISH
// ============================
function finishOnboarding() {
    localStorage.setItem('goalNinjaOnboarded', 'true');
    window.location.href = './goal-effect-home.html';
}

// ============================
// INIT
// ============================
(function init() {
    // If already onboarded, redirect
    if (localStorage.getItem('goalNinjaOnboarded') === 'true' && window.location.href.indexOf('preview') === -1) {
        window.location.href = './goal-effect-home.html';
        return;
    }

    // Check for existing name
    var existing = localStorage.getItem('goalNinjaUserName');
    if (existing) {
        userName = existing;
        document.getElementById('nameInput').value = existing;
    }

    // Init start date picker
    var startInput = document.getElementById('onbStartDateInput');
    if (startInput) {
        var today = GN_getTodayDateStr();
        startInput.min = today;
        startInput.value = today;
        selectedStartDate = today;
    }

    goTo(0);
})();
</script>
</body>
</html>